# Story Test Cases for Healthcare Triage Chatbot
# GitHub Repository: https://github.com/user/healthcare-chatbot
# MSc AI Assignment - Dialogue Flow Validation Tests

version: "3.1"

test_cases:

# ====== BASIC CONVERSATION FLOW TESTS ======
- test_case: basic greeting flow
  steps:
  - user: |
      hello
    intent: greet
  - action: utter_greet
  - user: |
      goodbye
    intent: goodbye
  - action: utter_goodbye

- test_case: bot challenge response
  steps:
  - user: |
      are you a robot?
    intent: bot_challenge
  - action: utter_default

# ====== SYMPTOM TRIAGE FLOW TESTS ======
- test_case: simple symptom triage - low priority
  steps:
  - user: |
      I have a mild headache
    intent: report_symptom
    entities:
      symptom: "headache"
      severity: "mild"
  - slot_was_set:
    - current_symptoms: ["headache"]
    - symptom_severity: "mild"
  - action: action_perform_triage
  - slot_was_set:
    - triage_priority: "low"
  - action: utter_triage_low_priority

- test_case: moderate symptom with appointment booking
  steps:
  - user: |
      I have moderate chest pain for 2 hours
    intent: report_symptom
    entities:
      symptom: "chest pain"
      severity: "moderate"
      duration: "2 hours"
  - slot_was_set:
    - current_symptoms: ["chest pain"]
    - symptom_severity: "moderate"
    - symptom_duration: "2 hours"
  - action: action_perform_triage
  - slot_was_set:
    - triage_priority: "medium"
  - action: utter_triage_medium_priority
  - user: |
      yes I want to book an appointment
    intent: affirm
  - action: utter_ask_appointment_date

- test_case: severe symptom high priority
  steps:
  - user: |
      I have severe abdominal pain
    intent: report_symptom
    entities:
      symptom: "abdominal pain"
      severity: "severe"
  - slot_was_set:
    - current_symptoms: ["abdominal pain"]
    - symptom_severity: "severe"
  - action: action_perform_triage
  - slot_was_set:
    - triage_priority: "high"
  - action: utter_triage_high_priority

- test_case: emergency situation
  steps:
  - user: |
      I think I'm having a heart attack
    intent: emergency_help
  - action: action_emergency_protocol
  - action: utter_triage_emergency
  - slot_was_set:
    - triage_priority: "emergency"

# ====== APPOINTMENT BOOKING FLOW TESTS ======
- test_case: complete appointment booking
  steps:
  - user: |
      I want to book an appointment
    intent: book_appointment
  - action: utter_ask_appointment_date
  - user: |
      tomorrow at 2 PM
    intent: book_appointment
    entities:
      appointment_date: "tomorrow"
      appointment_time: "2 PM"
  - slot_was_set:
    - appointment_date: "tomorrow"
    - appointment_time: "2 PM"
  - action: utter_ask_doctor_preference
  - user: |
      any doctor is fine
    intent: book_appointment
    entities:
      doctor_type: "any"
  - slot_was_set:
    - doctor_type: "any"
  - action: action_book_appointment
  - action: utter_appointment_confirmed

- test_case: appointment booking with patient details
  steps:
  - user: |
      book appointment for John Smith on Friday 3 PM with general practitioner
    intent: book_appointment
    entities:
      patient_name: "John Smith"
      appointment_date: "Friday"
      appointment_time: "3 PM"
      doctor_type: "general practitioner"
  - slot_was_set:
    - patient_name: "John Smith"
    - appointment_date: "Friday"
    - appointment_time: "3 PM"
    - doctor_type: "general practitioner"
  - action: action_book_appointment
  - action: utter_appointment_confirmed

- test_case: appointment modification
  steps:
  - user: |
      I want to change my appointment
    intent: modify_appointment
  - action: utter_ask_appointment_date
  - user: |
      change it to next week
    intent: modify_appointment
    entities:
      appointment_date: "next week"
  - slot_was_set:
    - appointment_date: "next week"
  - action: action_modify_appointment
  - action: utter_appointment_confirmed

- test_case: appointment cancellation
  steps:
  - user: |
      cancel my appointment
    intent: cancel_appointment
  - action: action_cancel_appointment
  - user: |
      yes confirm cancellation
    intent: affirm
  - action: utter_goodbye

# ====== HUMAN HANDOVER FLOW TESTS ======
- test_case: human handover request
  steps:
  - user: |
      I want to speak to a human
    intent: request_human_handover
  - action: action_initiate_handover
  - action: utter_human_handover
  - slot_was_set:
    - handover_requested: true

- test_case: handover after triage
  steps:
  - user: |
      I have chest pain
    intent: report_symptom
    entities:
      symptom: "chest pain"
  - slot_was_set:
    - current_symptoms: ["chest pain"]
  - action: action_perform_triage
  - user: |
      I want to talk to a real doctor
    intent: request_human_handover
  - action: action_initiate_handover
  - action: utter_handover_initiated

# ====== HEALTH ADVICE FLOW TESTS ======
- test_case: health advice request
  steps:
  - user: |
      what should I do about my symptoms
    intent: ask_health_advice
  - action: action_provide_health_advice
  - user: |
      thank you that helps
    intent: affirm
  - action: utter_thank_feedback

- test_case: health advice after triage
  steps:
  - user: |
      I have a sore throat
    intent: report_symptom
    entities:
      symptom: "sore throat"
  - slot_was_set:
    - current_symptoms: ["sore throat"]
  - action: action_perform_triage
  - slot_was_set:
    - triage_priority: "low"
  - action: utter_triage_low_priority
  - user: |
      give me some health advice
    intent: ask_health_advice
  - action: action_provide_health_advice

# ====== INFORMATION REQUEST FLOW TESTS ======
- test_case: clinic information requests
  steps:
  - user: |
      what are your hours
    intent: ask_clinic_hours
  - action: utter_clinic_hours
  - user: |
      what services do you offer
    intent: ask_services
  - action: utter_clinic_services

- test_case: privacy policy inquiry
  steps:
  - user: |
      how do you handle my data
    intent: ask_privacy_policy
  - action: utter_privacy_assurance
  - user: |
      okay I understand
    intent: affirm

# ====== FEEDBACK FLOW TESTS ======
- test_case: positive feedback
  steps:
  - user: |
      I rate this 5 stars
    intent: provide_feedback
    entities:
      feedback_rating: "5"
  - slot_was_set:
    - user_feedback_rating: 5.0
  - action: action_collect_feedback
  - action: utter_thank_feedback

- test_case: negative feedback with handover
  steps:
  - user: |
      this was disappointing
    intent: provide_feedback
    entities:
      feedback_rating: "poor"
  - action: action_collect_feedback
  - action: utter_thank_feedback

# ====== EXPLANATION AND TRANSPARENCY TESTS ======
- test_case: triage explanation request
  steps:
  - user: |
      I have back pain
    intent: report_symptom
    entities:
      symptom: "back pain"
  - slot_was_set:
    - current_symptoms: ["back pain"]
  - action: action_perform_triage
  - user: |
      why did you recommend this
    intent: ask_triage_explanation
  - action: action_explain_triage

# ====== ERROR HANDLING AND UNHAPPY PATHS ======
- test_case: user denies triage recommendation
  steps:
  - user: |
      I have a headache
    intent: report_symptom
    entities:
      symptom: "headache"
  - slot_was_set:
    - current_symptoms: ["headache"]
  - action: action_perform_triage
  - slot_was_set:
    - triage_priority: "low"
  - action: utter_triage_low_priority
  - user: |
      no that's not right
    intent: deny
  - action: utter_ask_symptoms

- test_case: out of scope with redirect
  steps:
  - user: |
      what's the weather today
    intent: out_of_scope
  - action: utter_out_of_scope
  - user: |
      I have fever
    intent: report_symptom
    entities:
      symptom: "fever"
  - slot_was_set:
    - current_symptoms: ["fever"]
  - action: action_perform_triage

- test_case: fallback with suggestions
  steps:
  - user: |
      blah blah nonsense
    intent: nlu_fallback
  - action: utter_default

# ====== COMPLEX MULTI-TURN CONVERSATIONS ======
- test_case: comprehensive healthcare journey
  steps:
  - user: |
      hello
    intent: greet
  - action: utter_greet
  - user: |
      I have stomach pain for 2 days, moderate severity
    intent: report_symptom
    entities:
      symptom: "stomach pain"
      severity: "moderate"
      duration: "2 days"
  - slot_was_set:
    - current_symptoms: ["stomach pain"]
    - symptom_severity: "moderate"
    - symptom_duration: "2 days"
  - action: action_perform_triage
  - slot_was_set:
    - triage_priority: "medium"
  - action: utter_triage_medium_priority
  - user: |
      what should I do
    intent: ask_health_advice
  - action: action_provide_health_advice
  - user: |
      book me an appointment for tomorrow
    intent: book_appointment
    entities:
      appointment_date: "tomorrow"
  - slot_was_set:
    - appointment_date: "tomorrow"
  - action: action_book_appointment
  - action: utter_appointment_confirmed
  - user: |
      explain why you recommended this
    intent: ask_triage_explanation
  - action: action_explain_triage
  - user: |
      I rate this 5 stars
    intent: provide_feedback
    entities:
      feedback_rating: "5"
  - slot_was_set:
    - user_feedback_rating: 5.0
  - action: action_collect_feedback
  - action: utter_thank_feedback
  - user: |
      goodbye
    intent: goodbye
  - action: utter_goodbye

# ====== EDGE CASES AND SPECIAL SCENARIOS ======
- test_case: elderly patient with multiple symptoms
  steps:
  - user: |
      I'm elderly and have dizziness and confusion
    intent: report_symptom
    entities:
      symptom: "dizziness"
      age_group: "elderly"
  - slot_was_set:
    - current_symptoms: ["dizziness"]
    - age_group: "elderly"
  - action: action_perform_triage
  - user: |
      also memory problems
    intent: report_symptom
    entities:
      symptom: "memory problems"
  - slot_was_set:
    - current_symptoms: ["dizziness", "memory problems"]
  - action: action_perform_triage
  - action: utter_triage_high_priority

- test_case: child patient safety protocol
  steps:
  - user: |
      my child has severe fever
    intent: report_symptom
    entities:
      symptom: "fever"
      severity: "severe"
      age_group: "child"
  - slot_was_set:
    - current_symptoms: ["fever"]
    - symptom_severity: "severe"
    - age_group: "child"
  - action: action_perform_triage
  - action: utter_triage_high_priority
  - action: action_initiate_handover

- test_case: anxious patient needing reassurance
  steps:
  - user: |
      I have mild chest tightness but I'm worried
    intent: report_symptom
    entities:
      symptom: "chest tightness"
      severity: "mild"
  - slot_was_set:
    - current_symptoms: ["chest tightness"]
    - symptom_severity: "mild"
  - action: action_perform_triage
  - user: |
      explain why this priority level
    intent: ask_triage_explanation
  - action: action_explain_triage
  - user: |
      what should I do
    intent: ask_health_advice
  - action: action_provide_health_advice

# ====== APPOINTMENT MANAGEMENT EDGE CASES ======
- test_case: appointment booking failure and retry
  steps:
  - user: |
      book appointment
    intent: book_appointment
  - action: utter_ask_appointment_date
  - user: |
      Sunday at midnight
    intent: book_appointment
    entities:
      appointment_date: "Sunday"
      appointment_time: "midnight"
  - slot_was_set:
    - appointment_date: "Sunday"
    - appointment_time: "midnight"
  - action: action_validate_appointment_slot
  - action: utter_ask_appointment_date
  - user: |
      Friday at 2 PM
    intent: book_appointment
    entities:
      appointment_date: "Friday"
      appointment_time: "2 PM"
  - slot_was_set:
    - appointment_date: "Friday"
    - appointment_time: "2 PM"
  - action: action_book_appointment
  - action: utter_appointment_confirmed

- test_case: user changes mind during booking
  steps:
  - user: |
      book appointment
    intent: book_appointment
  - action: utter_ask_appointment_date
  - user: |
      actually no, I have a cough
    intent: deny
  - user: |
      I have a cough
    intent: report_symptom
    entities:
      symptom: "cough"
  - slot_was_set:
    - current_symptoms: ["cough"]
  - action: action_perform_triage

# ====== COMPLIANCE AND SAFETY TESTS ======
- test_case: privacy concern handling
  steps:
  - user: |
      is this conversation private
    intent: ask_privacy_policy
  - action: utter_privacy_assurance
  - user: |
      okay, I have chest pain
    intent: report_symptom
    entities:
      symptom: "chest pain"
  - slot_was_set:
    - current_symptoms: ["chest pain"]
  - action: action_perform_triage

- test_case: multiple denial triggers handover
  steps:
  - user: |
      I have headache
    intent: report_symptom
    entities:
      symptom: "headache"
  - slot_was_set:
    - current_symptoms: ["headache"]
  - action: action_perform_triage
  - user: |
      no that's wrong
    intent: deny
  - user: |
      no I disagree
    intent: deny
  - action: action_initiate_handover
  - action: utter_human_handover

